<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="euc-kr">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>코드 변경사항 비교</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #4ec9b0;
            margin-bottom: 30px;
            font-size: 28px;
            text-align: center;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 40px;
        }
        .panel {
            background: #252526;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #3e3e42;
        }
        .panel-header {
            background: #2d2d30;
            padding: 12px 20px;
            font-weight: bold;
            border-bottom: 2px solid #007acc;
        }
        .original { border-bottom-color: #ce9178; }
        .changed { border-bottom-color: #4ec9b0; }
        .code {
            padding: 20px;
            font-size: 13px;
            overflow-x: auto;
        }
        .highlight-remove {
            background: rgba(255, 0, 0, 0.2);
            border-left: 3px solid #f14c4c;
            padding-left: 10px;
            margin-left: -10px;
        }
        .highlight-add {
            background: rgba(0, 255, 0, 0.2);
            border-left: 3px solid #89d185;
            padding-left: 10px;
            margin-left: -10px;
        }
        .highlight-new {
            background: rgba(100, 149, 237, 0.2);
            border-left: 3px solid #6495ed;
            padding-left: 10px;
            margin-left: -10px;
        }
        .comment {
            color: #6a9955;
        }
        .string {
            color: #ce9178;
        }
        .keyword {
            color: #569cd6;
        }
        .legend {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-bottom: 30px;
            padding: 15px;
            background: #252526;
            border-radius: 8px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        .box-remove { background: rgba(255, 0, 0, 0.3); border: 2px solid #f14c4c; }
        .box-add { background: rgba(0, 255, 0, 0.3); border: 2px solid #89d185; }
        .box-new { background: rgba(100, 149, 237, 0.3); border: 2px solid #6495ed; }
        pre { margin: 0; white-space: pre-wrap; word-break: break-word; }
        @media (max-width: 1200px) {
            .comparison { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>코드 변경사항 상세 비교</h1>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-box box-remove"></div>
                <span>삭제된 코드</span>
            </div>
            <div class="legend-item">
                <div class="legend-box box-add"></div>
                <span>수정된 코드</span>
            </div>
            <div class="legend-item">
                <div class="legend-box box-new"></div>
                <span>새로 추가된 코드</span>
            </div>
        </div>

        <!-- 변경 1: 새로운 함수 추가 -->
        <div class="comparison">
            <div class="panel">
                <div class="panel-header original">기존 코드</div>
                <div class="code">
                    <pre class="highlight-remove">// 이 함수는 존재하지 않았음</pre>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header changed">변경된 코드</div>
                <div class="code">
<pre class="highlight-new"><span class="comment">// ? 신규 추가: PC에서 스크롤 시 현재 섹션 감지</span>
<span class="keyword">function</span> updateActiveSection() {
    <span class="keyword">if</span> (isMobile()) <span class="keyword">return</span>;
    
    <span class="keyword">const</span> $header = $(<span class="string">'.headerOn'</span>);
    <span class="keyword">const</span> $anchorList = $(<span class="string">'.anchor-list'</span>);
    <span class="keyword">const</span> headerHeight = $header.outerHeight() || 0;
    <span class="keyword">const</span> anchorListHeight = $anchorList.hasClass(<span class="string">'fixed'</span>) 
        ? $anchorList.outerHeight() + 60
        : $anchorList.outerHeight() || 0;
    <span class="keyword">const</span> scrollTop = $(<span class="string">'body'</span>).scrollTop();
    <span class="keyword">const</span> offset = headerHeight + anchorListHeight + 100;
    
    <span class="keyword">let</span> currentSection = <span class="keyword">null</span>;
    
    $(<span class="string">'.anchor-panel'</span>).each(<span class="keyword">function</span>() {
        <span class="keyword">const</span> $panel = $(<span class="keyword">this</span>);
        <span class="keyword">const</span> panelTop = $panel.offset().top + scrollTop;
        <span class="keyword">const</span> panelBottom = panelTop + $panel.outerHeight();
        
        <span class="keyword">if</span> (scrollTop + offset >= panelTop && scrollTop + offset < panelBottom) {
            currentSection = <span class="string">'#'</span> + $panel.attr(<span class="string">'id'</span>);
            <span class="keyword">return false</span>;
        }
    });
    
    <span class="keyword">if</span> (currentSection) {
        <span class="keyword">const</span> $targetButton = $(<span class="string">`.anchor-list button[data-target="${currentSection}"]`</span>);
        <span class="keyword">if</span> ($targetButton.length && !$targetButton.hasClass(<span class="string">'active'</span>)) {
            $(<span class="string">'.anchor-list button'</span>).removeClass(<span class="string">'active'</span>);
            $targetButton.addClass(<span class="string">'active'</span>);
        }
    }
}</pre>
                </div>
            </div>
        </div>

        <!-- 변경 2: 함수명 및 적용 범위 변경 -->
        <div class="comparison">
            <div class="panel">
                <div class="panel-header original">기존 코드</div>
                <div class="code">
<pre><span class="comment">// 모바일 스크롤 이벤트 설정</span>
<span class="highlight-remove"><span class="keyword">function</span> setupMobileScroll() {</span>
    <span class="keyword">const</span> $body = $(<span class="string">'body'</span>);
    <span class="keyword">const</span> $header = $(<span class="string">'.headerOn'</span>);
    <span class="keyword">const</span> $visualContainer = $(<span class="string">'.visual-container'</span>);
    <span class="keyword">const</span> $anchorList = $(<span class="string">'.anchor-list'</span>);
    
    <span class="keyword">const</span> headerHeight = $header.outerHeight() || 0;
    <span class="keyword">const</span> visualHeight = $visualContainer.outerHeight() || 0;
    
    $body.off(<span class="string">'scroll.finance'</span>).on(<span class="string">'scroll.finance'</span>, <span class="keyword">function</span>() {
        <span class="keyword">const</span> scrollTop = $body.scrollTop();
<span class="highlight-remove">        $visualContainer.toggleClass(<span class="string">'sticky'</span>, scrollTop >= headerHeight);
        $anchorList.toggleClass(<span class="string">'fixed'</span>, scrollTop >= headerHeight + visualHeight);</span>
    });
}</pre>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header changed">변경된 코드</div>
                <div class="code">
<pre><span class="comment">// ? PC/모바일 통합 스크롤 이벤트 설정</span>
<span class="highlight-add"><span class="keyword">function</span> setupScroll() {</span>
    <span class="keyword">const</span> $body = $(<span class="string">'body'</span>);
    <span class="keyword">const</span> $header = $(<span class="string">'.headerOn'</span>);
    <span class="keyword">const</span> $visualContainer = $(<span class="string">'.visual-container'</span>);
    <span class="keyword">const</span> $anchorList = $(<span class="string">'.anchor-list'</span>);
    
    <span class="keyword">const</span> headerHeight = $header.outerHeight() || 0;
    <span class="keyword">const</span> visualHeight = $visualContainer.outerHeight() || 0;
    
    $body.off(<span class="string">'scroll.finance'</span>).on(<span class="string">'scroll.finance'</span>, <span class="keyword">function</span>() {
        <span class="keyword">const</span> scrollTop = $body.scrollTop();
<span class="highlight-add">        <span class="keyword">const</span> shouldBeFixed = scrollTop >= headerHeight + visualHeight;
        
        $visualContainer.toggleClass(<span class="string">'sticky'</span>, shouldBeFixed);
        $anchorList.toggleClass(<span class="string">'fixed'</span>, shouldBeFixed);
        
        <span class="comment">// ? PC에서 스크롤 시 현재 섹션 활성화</span>
        <span class="keyword">if</span> (!isMobile() && shouldBeFixed) {
            updateActiveSection();
        }</span>
    });
}</pre>
                </div>
            </div>
        </div>

        <!-- 변경 3: 초기화 부분 -->
        <div class="comparison">
            <div class="panel">
                <div class="panel-header original">기존 코드</div>
                <div class="code">
<pre><span class="comment">// 초기화</span>
initPanels();
<span class="highlight-remove"><span class="keyword">if</span> (isMobile()) setupMobileScroll();</span></pre>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header changed">변경된 코드</div>
                <div class="code">
<pre><span class="comment">// ? 초기화 (PC/모바일 모두 적용)</span>
initPanels();
<span class="highlight-add">setupScroll();</span></pre>
                </div>
            </div>
        </div>

        <!-- 변경 4: PC 클릭 이벤트 -->
        <div class="comparison">
            <div class="panel">
                <div class="panel-header original">기존 코드</div>
                <div class="code">
<pre>} <span class="keyword">else</span> {
    <span class="comment">// PC: 스크롤 이동</span>
    <span class="keyword">const</span> $target = $(target);
    <span class="keyword">if</span> ($target.length) {
<span class="highlight-remove">        <span class="keyword">const</span> headerHeight = $(<span class="string">'.headerOn'</span>).outerHeight() || 0;
        <span class="keyword">const</span> anchorListHeight = $(<span class="string">'.anchor-list'</span>).outerHeight() || 0;
        <span class="keyword">const</span> offset = headerHeight + anchorListHeight - 70;</span>
        
        $(<span class="string">'body'</span>).stop().animate({
            scrollTop: $target.offset().top + $(<span class="string">'body'</span>).scrollTop() - offset
        }, 400);
    }
}</pre>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header changed">변경된 코드</div>
                <div class="code">
<pre>} <span class="keyword">else</span> {
    <span class="comment">// PC: 스크롤 이동</span>
    <span class="keyword">const</span> $target = $(target);
    <span class="keyword">if</span> ($target.length) {
<span class="highlight-add">        <span class="keyword">const</span> $anchorList = $(<span class="string">'.anchor-list'</span>);
        <span class="keyword">const</span> headerHeight = $(<span class="string">'.headerOn'</span>).outerHeight() || 0;
        <span class="comment">// ? fixed일 때 padding 높이 반영</span>
        <span class="keyword">const</span> anchorListHeight = $anchorList.hasClass(<span class="string">'fixed'</span>)
            ? $anchorList.outerHeight() + 60
            : $anchorList.outerHeight() || 0;
        <span class="keyword">const</span> offset = headerHeight + anchorListHeight - 70;</span>
        
        $(<span class="string">'body'</span>).stop().animate({
            scrollTop: $target.offset().top + $(<span class="string">'body'</span>).scrollTop() - offset
        }, 400);
    }
}</pre>
                </div>
            </div>
        </div>

        <!-- 변경 5: 리사이즈 이벤트 -->
        <div class="comparison">
            <div class="panel">
                <div class="panel-header original">기존 코드</div>
                <div class="code">
<pre><span class="keyword">let</span> resizeTimer;
$(window).on(<span class="string">'resize'</span>, <span class="keyword">function</span>() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(() => {
<span class="highlight-remove">        <span class="keyword">if</span> (isMobile()) {
            setupMobileScroll();
        } <span class="keyword">else</span> {
            $(<span class="string">'.visual-container'</span>).removeClass(<span class="string">'sticky'</span>);
            $(<span class="string">'.anchor-list'</span>).removeClass(<span class="string">'fixed'</span>);
            $(<span class="string">'body'</span>).off(<span class="string">'scroll.finance'</span>);
        }</span>
        initPanels();
    }, 150);
});</pre>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header changed">변경된 코드</div>
                <div class="code">
<pre><span class="keyword">let</span> resizeTimer;
$(window).on(<span class="string">'resize'</span>, <span class="keyword">function</span>() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(() => {
<span class="highlight-add">        <span class="keyword">if</span> (!isMobile()) {
            <span class="comment">// ? PC로 전환 시 스크롤 이벤트 재설정</span>
            setupScroll();
        }</span>
        initPanels();
    }, 150);
});</pre>
                </div>
            </div>
        </div>
    </div>
</body>
</html>